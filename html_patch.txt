        elif format == "html":
            return f"""<html>
<head>
    <title>Monthly Digest - {date.today().strftime('%Y-%m')}</title>
    <style>
        body {{ font-family: Arial, sans-serif; margin: 20px; }}
        .summary {{ background: #f5f5f5; padding: 15px; border-radius: 5px; }}
        .label {{ color: #666; }}
    </style>
</head>
<body>
    <h1>Monthly Digest - {date.today().strftime('%Y-%m')}</h1>
    <div class="summary">
        <h2>Summary</h2>
        <ul>
            <li>âœ… <strong>{stats['this_month']['completed']}</strong> tasks completed this month</li>
            <li>ğŸ“ <strong>{stats['this_month']['created']}</strong> new tasks added this month</li>
            <li>ğŸ•— <strong>{len(stats['overdue']['30_days'])}</strong> tasks still open > 30 days</li>
            <li>ğŸ” <strong>{len(stats['recurring'])}</strong> recurring tasks flagged as overdue</li>
        </ul>
    </div>
    <h2>Top Labels</h2>
    {self._format_label_summary_html(stats['by_label'])}
</body>
</html>"""
